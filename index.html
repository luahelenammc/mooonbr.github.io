<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Portal da Moon</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />

  <!-- jQuery (para facilitar a vida do JS do template) -->
  <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.min.js"></script>

  <style>
    :root {
      --azul: #245edb;
      --azul-medio: #3f8cf3;
      --azul-claro: #0c8dea;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      padding: 0;
      font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #000;
      overflow-y: auto; /* deixa scroll disponível se o conteúdo passar da tela */
    }

    #windowsXP {
      display: flex;
      width: 100vw;
      min-height: 100vh; /* altura mínima = viewport, mas pode crescer se os ícones precisarem */
    }

    .area-de-trabalho {
      position: relative;
      flex: 1;
      min-height: 100vh;
      width: 100vw;
      background: url("https://images2.alphacoders.com/941/941898.jpg") center/cover no-repeat fixed;
    }

    /* Ícones do desktop */
    .desktop-icon {
      position: absolute;
      width: 120px;
      height: 140px;
      padding: 12px 6px 4px;
      text-align: center;
      overflow: hidden;
      z-index: 1;
      cursor: default;
      user-select: none;
    }

    .desktop-icon img {
      max-width: 72px;
      max-height: 72px;
      width: auto;
      height: auto;
      display: block;
      margin: 0 auto 4px;
      box-shadow: none;
      pointer-events: none;
    }

    .desktop-icon span {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      white-space: normal;
      color: #fff;
      font-size: 14px;
      text-shadow: 2px 2px 8px #000;
    }

    .desktop-icon.selected span {
      background: #004E98;
    }

    /* Barra de tarefas */
    .barra-de-tarefas {
      position: fixed;
      left: 0;
      bottom: 0;
      width: 100vw;
      height: 50px;
      display: flex;
      justify-content: space-between;
      align-items: stretch;
      background: linear-gradient(
        to bottom,
        var(--azul) 0%,
        var(--azul-claro) 9%,
        var(--azul) 18%,
        var(--azul) 92%,
        #333 100%
      );
      z-index: 995;
    }

    #iniciar {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 180px;
      padding: 0 16px;
      border: none;
      margin-right: 12px;
      background: linear-gradient(
        to bottom,
        #3d973d 0%,
        #6faf72 9%,
        #3d973d 18%,
        #3d973d 92%,
        #666 100%
      );
      border-top-right-radius: 15px;
      border-bottom-right-radius: 15px;
      cursor: pointer;
      color: #fff;
      font-size: 1.5rem;
      font-weight: bold;
      text-shadow: 2px 2px 8px #003d00;
    }

    #iniciar img {
      width: 26px;
      height: 26px;
      margin-right: 8px;
    }

    #iniciar:hover {
      background: linear-gradient(
        to bottom,
        #3d973d 0%,
        #6faf72 9%,
        #3d973d 18%,
        #37d437 92%,
        #666 100%
      );
    }

    #iniciar.active {
      box-shadow: inset 0 6px 6px -6px #000;
    }

    .programas-abertos {
      flex: 1;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .area-de-notificacao {
      display: flex;
      align-items: center;
      justify-content: space-between;
      width: 230px;
      background: linear-gradient(
        to bottom,
        #0fadf4 0%,
        #0fadf4 9%,
        #108ae5 18%,
        #108ae5 92%,
        #666 100%
      );
      padding: 0 8px;
    }

    .tray-icons {
      display: flex;
      gap: 6px;
      align-items: center;
      margin-left: 6px;
    }

    .tray-icons img {
      width: 22px;
      height: 22px;
    }

    #relogio {
      margin-right: 4px;
      color: #fff;
      font-size: 16px;
      font-weight: bold;
    }

    /* Menu Iniciar */

    #menuIniciar {
      position: fixed;
      left: 0;
      bottom: 50px;
      width: 500px;
      height: 560px;
      display: none;
      flex-direction: column;
      background: #fff;
      border-top-right-radius: 10px;
      border-right: 3px solid var(--azul);
      z-index: 999;
      box-shadow: 0 0 18px rgba(0,0,0,0.6);
      overflow: hidden;
    }

    #menuIniciar.active {
      display: flex;
    }

    .topoIniciar {
      display: flex;
      align-items: center;
      height: 90px;
      background: linear-gradient(
        to bottom,
        var(--azul) 0%,
        var(--azul-claro) 9%,
        var(--azul) 18%,
        var(--azul) 92%,
        var(--azul) 100%
      );
    }

    .avatarIniciar {
      width: 70px;
      height: 70px;
      margin-left: 16px;
      border-radius: 10px;
      background: #fff url("/images/moonvrjan26.webp") center/cover no-repeat;
    }

    .userName {
      margin-left: 18px;
      color: #fff;
      font-size: 20px;
    }

    .mioloIniciar {
      display: flex;
      flex: 1;
      padding: 8px 0;
    }

    .col {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
      overflow: hidden;
    }

    .tituloColuna {
      padding: 4px 10px;
      font-size: 12px;
      color: #555;
      font-weight: bold;
      border-bottom: 1px solid #ccc;
      margin-bottom: 2px;
    }

    .itemIniciar {
      display: flex;
      align-items: center;
      padding: 6px 12px;
      cursor: default;
    }

    .itemIniciar img {
      width: 26px;
      height: 26px;
      margin-right: 8px;
    }

    .itemIniciar span {
      font-size: 13px;
      color: #666;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .itemIniciar span strong {
      color: #000;
    }

    .itemIniciar:hover {
      background: var(--azul-claro);
    }

    .itemIniciar:hover span,
    .itemIniciar:hover span strong {
      color: #fff;
    }

    .footerIniciar {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      height: 60px;
      padding-right: 16px;
      background: linear-gradient(
        to bottom,
        var(--azul) 0%,
        var(--azul-claro) 9%,
        var(--azul) 18%,
        var(--azul) 92%,
        var(--azul) 100%
      );
      color: #fff;
      font-size: 13px;
      gap: 16px;
    }

    .footerIniciar span {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      cursor: default;
    }

    .footerIniciar img {
      width: 18px;
      height: 18px;
    }

    /* Responsivo - mobile */
    @media (max-width: 900px), (pointer: coarse) {
      .desktop-icon {
        width: 120px;
        height: 140px;
        padding: 10px 6px 4px;
      }

      .desktop-icon img {
        max-width: 80px;
        max-height: 80px;
      }

      .desktop-icon span {
        font-size: 14px;
      }

      #menuIniciar {
        width: 92vw;
        left: 4vw;
      }
    }
  </style>
</head>
<body>
  <div id="windowsXP">
    <div class="area-de-trabalho" id="desktopArea">
      <!-- Ícones são renderizados via JS -->

      <!-- Menu Iniciar -->
      <div id="menuIniciar">
        <div class="topoIniciar">
          <div class="avatarIniciar"></div>
          <div class="userName">Lua Helena Moon</div>
        </div>

        <div class="mioloIniciar">
          <div class="col">
            <div class="tituloColuna">Programas (clássicos)</div>

            <div class="itemIniciar">
              <img src="/images/ie.png" alt="IE" />
              <span><strong>Internet</strong><br/>Internet Explorer</span>
            </div>
            <div class="itemIniciar">
              <img src="/images/wmp.png" alt="WMP" />
              <span><strong>Windows Media Player</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/msn.png" alt="MSN" />
              <span><strong>Windows Messenger</strong></span>
            </div>
          </div>

          <div class="col">
            <div class="tituloColuna">Moon (espelho do desktop)</div>

            <div class="itemIniciar">
              <img src="/images/snes.png" alt="Blog Nostalgia" />
              <span><strong>BLOG NOSTALGIA</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/habbo hc.fw.png" alt="Habbo" />
              <span><strong>Habbo Hotel</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/ps1.png" alt="PS1" />
              <span><strong>Playstation 1</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/ps2.png" alt="PS2" />
              <span><strong>Playstation 2</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/supern.png" alt="SNES" />
              <span><strong>Super Nintendo</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/insta.png" alt="Instagram" />
              <span><strong>Instagram</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/tiktok.png" alt="Tiktok" />
              <span><strong>Tiktok</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/twitch.png" alt="Twitch" />
              <span><strong>Twitch</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/youtube.png" alt="YouTube" />
              <span><strong>Youtube</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/ringtone.png" alt="Playlists" />
              <span><strong>Playlists nostálgicas</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/music_icon_trophy.png" alt="Músicas IA" />
              <span><strong>Músicas geradas por IA</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/series.png" alt="Moon TV" />
              <span><strong>Moon TV</strong></span>
            </div>
            <div class="itemIniciar">
              <img src="/images/pokeshelf.png" alt="Pokémon" />
              <span><strong>Meus Pokémon</strong></span>
            </div>
          </div>
        </div>

        <div class="footerIniciar">
          <span><img src="/images/logout.png" alt="Logoff" />Fazer Logoff</span>
          <span><img src="/images/shutdown.png" alt="Desligar" />Desligar</span>
        </div>
      </div>

      <!-- Barra de tarefas -->
      <div class="barra-de-tarefas">
        <button id="iniciar">
          <img src="/images/logo-windows.png" alt="Windows" />
          Iniciar
        </button>

        <div class="programas-abertos">
          <!-- ícones de programas abertos, se um dia você quiser -->
        </div>

        <div class="area-de-notificacao">
          <div class="tray-icons">
            <img src="/images/volume.png" alt="Volume" />
            <img src="/images/media.png" alt="Media" />
            <img src="/images/security.png" alt="Segurança" />
          </div>
          <div id="relogio">00:00</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --------------------------
    // Configuração dos ícones
    // --------------------------
    const DESKTOP_ICONS = [
      { id: "blog_nostalgia", label: "BLOG NOSTALGIA", img: "/images/snes.png", link: "https://nostalgia.mooon.com.br", row: 0, col: 0 },
      { id: "habbo",          label: "Habbo Hotel",     img: "/images/habbo hc.fw.png", link: "https://nostalgia.mooon.com.br/2025/12/habbo-hotel.html",   row: 0, col: 1 },
      { id: "ps1",            label: "Playstation 1",   img: "/images/ps1.png",   link: "https://nostalgia.mooon.com.br/search/label/PlayStation%201", row: 0, col: 2 },
      { id: "ps2",            label: "Playstation 2",   img: "/images/ps2.png",   link: "https://nostalgia.mooon.com.br/search/label/PlayStation%202", row: 0, col: 3 },
      { id: "snes",           label: "Super Nintendo",  img: "/images/supern.png",  link: "https://nostalgia.mooon.com.br/search/label/Super%20Nintendo",row: 0, col: 4 },

      { id: "instagram",      label: "Instagram",       img: "/images/insta.png", link: "https://instagram.com/mooon.br", row: 1, col: 0 },
      { id: "tiktok",         label: "Tiktok",          img: "/images/tiktok.png",    link: "https://tiktok.com/@mooon.br",    row: 1, col: 1 },
      { id: "twitch",         label: "Twitch",          img: "/images/twitch.png",    link: "https://twitch.tv/mooonbr",    row: 1, col: 2 },
      { id: "youtube",        label: "Youtube",         img: "/images/youtube.png",   link: "https://youtube.com/channel/UCst0jXP1CRb-_1S00F1NMgQ",   row: 1, col: 3 },

      { id: "playlists",      label: "Playlists nostálgicas", img: "/images/ringtone.png", link: "/musicas.html", row: 2, col: 0 },
      { id: "musicas_ia",     label: "Músicas geradas por IA", img: "/images/music_icon_trophy.png", link: "/aimusic.html", row: 2, col: 1 },
      { id: "moon_tv",        label: "Moon TV",         img: "/images/series.png",  link: "/tv/index.html",   row: 2, col: 2 },
      { id: "pokemon",        label: "Meus Pokémon",    img: "/images/pokeshelf.png",  link: "/pokemon.html",   row: 2, col: 3 }
    ];

    function isMobileLayout() {
      return window.matchMedia("(max-width: 900px)").matches ||
             window.matchMedia("(pointer: coarse)").matches;
    }

    function renderDesktopIcons() {
      const desktop = document.getElementById("desktopArea");
      if (!desktop) return;

      // remove ícones antigos
      desktop.querySelectorAll(".desktop-icon").forEach(el => el.remove());

      const mobile = isMobileLayout();

      // Configuração básica da grade
      let marginX = mobile ? 26 : 20;
      let marginY = mobile ? 40 : 30;
      let stepX   = mobile ? 140 : 110;
      let stepY   = mobile ? 165 : 135;

      // Em mobile, comprimimos as linhas (0,2,3 -> 0,1,2) pra caber melhor
      function normalizeRow(row) {
        if (!mobile) return row;
        if (row === 2) return 1;
        if (row === 3) return 2;
        return row;
      }

      // descobre quantas linhas teremos depois da normalização
      const rowsUsed = new Set(DESKTOP_ICONS.map(i => normalizeRow(i.row)));
      const rowCount = rowsUsed.size;

      if (mobile) {
        const viewportHeight = window.innerHeight || 700;
        const taskbarHeight = 50;
        const iconHeightEst = 140;

        const available = viewportHeight - taskbarHeight - 40; // margem top+bottom
        // recalcula stepY pra caber confortável
        stepY = Math.min(170, Math.max(120, Math.floor((available - iconHeightEst) / Math.max(1, rowCount - 1))));
        marginY = Math.max(20, Math.floor((available - (rowCount - 1) * stepY - iconHeightEst) / 2));
      }

      let maxBottom = 0;

      DESKTOP_ICONS.forEach(icon => {
        const iconDiv = document.createElement("div");
        iconDiv.className = "desktop-icon";
        iconDiv.id = icon.id;
        iconDiv.dataset.link = icon.link || "";
        iconDiv.innerHTML = `
          <img src="${icon.img}" alt="${icon.label}">
          <span>${icon.label}</span>
        `;

        const row = normalizeRow(icon.row);
        const col = icon.col || 0;

        const left = marginX + col * stepX;
        const top  = marginY + row * stepY;

        iconDiv.style.left = left + "px";
        iconDiv.style.top  = top + "px";

        // clique = abre link
        iconDiv.addEventListener("click", (ev) => {
          ev.preventDefault();
          const href = icon.link;
          if (href) {
            window.location.href = href;
          }
        });

        desktop.appendChild(iconDiv);

        const bottom = top + 140; // altura estimada do bloco
        if (bottom > maxBottom) maxBottom = bottom;
      });

      // garante que a área de trabalho tenha altura suficiente pra permitir scroll
      const minHeight = Math.max(window.innerHeight || 0, maxBottom + 40);
      desktop.style.height = minHeight + "px";
      document.getElementById("windowsXP").style.minHeight = minHeight + "px";
    }

    // Atualiza relógio da barra
    function atualizarRelogio() {
      const relogio = document.getElementById("relogio");
      if (!relogio) return;
      const agora = new Date();
      const hh = String(agora.getHours()).padStart(2, "0");
      const mm = String(agora.getMinutes()).padStart(2, "0");
      relogio.textContent = hh + ":" + mm;
    }

    document.addEventListener("DOMContentLoaded", () => {
      renderDesktopIcons();
      atualizarRelogio();
      setInterval(atualizarRelogio, 30000);

      // redimensionamento / orientação
      window.addEventListener("resize", renderDesktopIcons, { passive: true });
      window.addEventListener("orientationchange", renderDesktopIcons, { passive: true });

      // botão iniciar
      const btnIniciar = document.getElementById("iniciar");
      const menuIniciar = document.getElementById("menuIniciar");

      btnIniciar.addEventListener("click", (ev) => {
        ev.stopPropagation();
        const ativo = menuIniciar.classList.toggle("active");
        btnIniciar.classList.toggle("active", ativo);
      });

      // fechar menu ao clicar fora
      document.addEventListener("click", (ev) => {
        const menu = document.getElementById("menuIniciar");
        const btn = document.getElementById("iniciar");
        if (!menu.contains(ev.target) && !btn.contains(ev.target)) {
          menu.classList.remove("active");
          btn.classList.remove("active");
        }
      });
    });
  </script>
</body>
</html>
